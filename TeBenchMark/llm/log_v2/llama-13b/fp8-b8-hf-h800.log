Namespace(backend='hf', dtype='fp8', dataset='../ShareGPT_V3_unfiltered_cleaned_split.json', model='/workspace/dudayou/hf-models/hf-llama-2-13b/', tokenizer='/workspace/dudayou/hf-models/hf-llama-2-13b/', quantization=None, tensor_parallel_size=1, n=1, use_beam_search=False, num_prompts=504, seed=0, hf_max_batch_size=8, trust_remote_code=False, output_len=128, input_len=128)
tokenizering ...
finish tokenize !
loading model /workspace/dudayou/hf-models/hf-llama-2-13b/
Loading checkpoint shards:   0%|          | 0/3 [00:00<?, ?it/s]Loading checkpoint shards:  33%|███▎      | 1/3 [00:16<00:33, 16.73s/it]Loading checkpoint shards:  67%|██████▋   | 2/3 [00:33<00:16, 16.61s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:43<00:00, 13.74s/it]Loading checkpoint shards: 100%|██████████| 3/3 [00:43<00:00, 14.53s/it]
/workspace/software/anaconda3/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:492: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.
  warnings.warn(
/workspace/software/anaconda3/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:497: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`. This was detected when initializing the generation config instance, which means the corresponding file may hold incorrect parameterization and should be fixed.
  warnings.warn(
/workspace/software/anaconda3/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:492: UserWarning: `do_sample` is set to `False`. However, `temperature` is set to `0.9` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `temperature`.
  warnings.warn(
/workspace/software/anaconda3/lib/python3.11/site-packages/transformers/generation/configuration_utils.py:497: UserWarning: `do_sample` is set to `False`. However, `top_p` is set to `0.6` -- this flag is only used in sample-based generation modes. You should set `do_sample=True` or unset `top_p`.
  warnings.warn(
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
convert to te.linear
model created!! torch.bfloat16 cuda:0
  0%|          | 0/504 [00:00<?, ?it/s]  2%|▏         | 8/504 [00:06<06:32,  1.26it/s]  3%|▎         | 16/504 [00:12<06:13,  1.31it/s]  5%|▍         | 24/504 [00:18<06:03,  1.32it/s]  6%|▋         | 32/504 [00:24<05:55,  1.33it/s]  8%|▊         | 40/504 [00:30<05:48,  1.33it/s] 10%|▉         | 48/504 [00:36<05:41,  1.33it/s] 11%|█         | 56/504 [00:42<05:35,  1.34it/s] 13%|█▎        | 64/504 [00:48<05:29,  1.34it/s] 14%|█▍        | 72/504 [00:54<05:23,  1.34it/s] 16%|█▌        | 80/504 [01:00<05:16,  1.34it/s] 17%|█▋        | 88/504 [01:06<05:11,  1.34it/s] 19%|█▉        | 96/504 [01:12<05:05,  1.34it/s] 21%|██        | 104/504 [01:18<04:58,  1.34it/s] 22%|██▏       | 112/504 [01:24<04:52,  1.34it/s] 24%|██▍       | 120/504 [01:30<04:46,  1.34it/s] 25%|██▌       | 128/504 [01:35<04:40,  1.34it/s] 27%|██▋       | 136/504 [01:41<04:34,  1.34it/s] 29%|██▊       | 144/504 [01:47<04:28,  1.34it/s] 30%|███       | 152/504 [01:53<04:22,  1.34it/s] 32%|███▏      | 160/504 [01:59<04:16,  1.34it/s] 33%|███▎      | 168/504 [02:05<04:10,  1.34it/s] 35%|███▍      | 176/504 [02:11<04:04,  1.34it/s] 37%|███▋      | 184/504 [02:17<03:59,  1.34it/s] 38%|███▊      | 192/504 [02:23<03:53,  1.34it/s] 40%|███▉      | 200/504 [02:29<03:47,  1.34it/s] 41%|████▏     | 208/504 [02:35<03:41,  1.34it/s] 43%|████▎     | 216/504 [02:41<03:35,  1.34it/s] 44%|████▍     | 224/504 [02:47<03:29,  1.34it/s] 46%|████▌     | 232/504 [02:53<03:22,  1.34it/s] 48%|████▊     | 240/504 [02:59<03:16,  1.34it/s] 49%|████▉     | 248/504 [03:05<03:10,  1.34it/s] 51%|█████     | 256/504 [03:11<03:04,  1.35it/s] 52%|█████▏    | 264/504 [03:17<02:58,  1.35it/s] 54%|█████▍    | 272/504 [03:23<02:52,  1.35it/s] 56%|█████▌    | 280/504 [03:29<02:45,  1.35it/s] 57%|█████▋    | 288/504 [03:35<02:39,  1.35it/s] 59%|█████▊    | 296/504 [03:41<02:33,  1.35it/s] 60%|██████    | 304/504 [03:46<02:28,  1.35it/s] 62%|██████▏   | 312/504 [03:52<02:22,  1.35it/s] 63%|██████▎   | 320/504 [03:58<02:16,  1.35it/s] 65%|██████▌   | 328/504 [04:04<02:10,  1.35it/s] 67%|██████▋   | 336/504 [04:10<02:04,  1.35it/s] 68%|██████▊   | 344/504 [04:16<01:59,  1.34it/s] 70%|██████▉   | 352/504 [04:22<01:53,  1.34it/s] 71%|███████▏  | 360/504 [04:28<01:47,  1.34it/s] 73%|███████▎  | 368/504 [04:34<01:42,  1.33it/s] 75%|███████▍  | 376/504 [04:40<01:36,  1.33it/s] 76%|███████▌  | 384/504 [04:46<01:29,  1.34it/s] 78%|███████▊  | 392/504 [04:52<01:24,  1.33it/s] 79%|███████▉  | 400/504 [04:58<01:17,  1.34it/s] 81%|████████  | 408/504 [05:04<01:11,  1.34it/s] 83%|████████▎ | 416/504 [05:10<01:05,  1.34it/s] 84%|████████▍ | 424/504 [05:16<00:59,  1.35it/s] 86%|████████▌ | 432/504 [05:22<00:53,  1.35it/s] 87%|████████▋ | 440/504 [05:28<00:47,  1.35it/s] 89%|████████▉ | 448/504 [05:34<00:41,  1.35it/s] 90%|█████████ | 456/504 [05:40<00:35,  1.35it/s] 92%|█████████▏| 464/504 [05:46<00:29,  1.35it/s] 94%|█████████▎| 472/504 [05:52<00:23,  1.35it/s] 95%|█████████▌| 480/504 [05:58<00:17,  1.35it/s] 97%|█████████▋| 488/504 [06:04<00:11,  1.35it/s] 98%|█████████▊| 496/504 [06:09<00:05,  1.35it/s]100%|██████████| 504/504 [06:15<00:00,  1.35it/s]100%|██████████| 504/504 [06:15<00:00,  1.34it/s]
Throughput: 1.34 requests/s, 343.25 tokens/s
